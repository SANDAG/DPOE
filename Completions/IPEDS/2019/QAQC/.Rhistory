# colnames(db_2013)
# colnames(source_2014)
# colnames(db_2014)
# colnames(source_2015)
# colnames(db_2015)
# colnames(source_2016)
# colnames(db_2016)
# colnames(source_2017)
# colnames(db_2017)
#Rename columns with an extra space
db_2010 <- plyr::rename(db_2010, c("DVCWHW  "="DVCWHW"))
db_2011 <- plyr::rename(db_2011, c("CNRALW  "="CNRALW"))
db_2012 <- plyr::rename(db_2012, c("CNRALW  "="CNRALW"))
db_2013 <- plyr::rename(db_2013, c("CNRALW  "="CNRALW"))
db_2014 <- plyr::rename(db_2014, c("CNRALW  "="CNRALW"))
db_2015 <- plyr::rename(db_2015, c("CNRALW  "="CNRALW"))
db_2016 <- plyr::rename(db_2016, c("CNRALW  "="CNRALW"))
db_2017 <- plyr::rename(db_2017, c("CNRALW  "="CNRALW"))
#Verify that this worked
# all(colnames(source_2010) == colnames(db_2010))
# all(colnames(source_2011) == colnames(db_2011))
# all(colnames(source_2012) == colnames(db_2012))
# all(colnames(source_2013) == colnames(db_2013))
# all(colnames(source_2014) == colnames(db_2014))
# all(colnames(source_2015) == colnames(db_2015))
# all(colnames(source_2016) == colnames(db_2016))
# all(colnames(source_2017) == colnames(db_2017))
#Check data types
# #2010
# str(source_2010)
# str(db_2010)
# all(str(source_2010) == str(db_2010))
# #2011
# str(source_2011)
# str(db_2011)
# all(str(source_2011) == str(db_2011))
# #2012
# str(source_2012)
# str(db_2012)
# all(str(source_2012) == str(db_2012))
# #2013
# str(source_2013)
# str(db_2013)
# all(str(source_2013) == str(db_2013))
# #2014
# str(source_2014)
# str(db_2014)
# all(str(source_2014) == str(db_2014))
# #2015
# str(source_2015)
# str(db_2015)
# all(str(source_2015) == str(db_2015))
# #2016
# str(source_2016)
# str(db_2016)
# all(str(source_2016) == str(db_2016))
# #2017
# str(source_2017)
# str(db_2017)
# all(str(source_2017) == str(db_2017))
#Remove quotes from data
#2010
db_2010$"XC2MORM"<-gsub('"', "", db_2010$"XC2MORM")
db_2010$"XC2MORT"<-gsub('"', "", db_2010$"XC2MORT")
db_2010$"XC2MORW"<-gsub('"', "", db_2010$"XC2MORW")
db_2010$"XCAIANM"<-gsub('"', "", db_2010$"XCAIANM")
db_2010$"XCAIANT"<-gsub('"', "", db_2010$"XCAIANT")
db_2010$"XCAIANW"<-gsub('"', "", db_2010$"XCAIANW")
db_2010$"XCASIAM"<-gsub('"', "", db_2010$"XCASIAM")
db_2010$"XCASIAT"<-gsub('"', "", db_2010$"XCASIAT")
db_2010$"XCASIAW"<-gsub('"', "", db_2010$"XCASIAW")
db_2010$"XCBKAAM"<-gsub('"', "", db_2010$"XCBKAAM")
db_2010$"XCBKAAT"<-gsub('"', "", db_2010$"XCBKAAT")
db_2010$"XCBKAAW"<-gsub('"', "", db_2010$"XCBKAAW")
db_2010$"XCHISPM"<-gsub('"', "", db_2010$"XCHISPM")
db_2010$"XCHISPT"<-gsub('"', "", db_2010$"XCHISPT")
db_2010$"XCHISPW"<-gsub('"', "", db_2010$"XCHISPW")
db_2010$"XCNHPIM"<-gsub('"', "", db_2010$"XCNHPIM")
db_2010$"XCNHPIT"<-gsub('"', "", db_2010$"XCNHPIT")
db_2010$"XCNHPIW"<-gsub('"', "", db_2010$"XCNHPIW")
db_2010$"XCNRALM"<-gsub('"', "", db_2010$"XCNRALM")
db_2010$"XCNRALT"<-gsub('"', "", db_2010$"XCNRALT")
db_2010$"XCNRALW"<-gsub('"', "", db_2010$"XCNRALW")
db_2010$"XCRACE03"<-gsub('"', "", db_2010$"XCRACE03")
db_2010$"XCRACE04"<-gsub('"', "", db_2010$"XCRACE04")
db_2010$"XCRACE05"<-gsub('"', "", db_2010$"XCRACE05")
db_2010$"XCRACE06"<-gsub('"', "", db_2010$"XCRACE06")
db_2010$"XCRACE07"<-gsub('"', "", db_2010$"XCRACE07")
db_2010$"XCRACE08"<-gsub('"', "", db_2010$"XCRACE08")
db_2010$"XCRACE09"<-gsub('"', "", db_2010$"XCRACE09")
db_2010$"XCRACE10"<-gsub('"', "", db_2010$"XCRACE10")
db_2010$"XCRACE11"<-gsub('"', "", db_2010$"XCRACE11")
db_2010$"XCRACE12"<-gsub('"', "", db_2010$"XCRACE12")
db_2010$"XCRACE18"<-gsub('"', "", db_2010$"XCRACE18")
db_2010$"XCRACE19"<-gsub('"', "", db_2010$"XCRACE19")
db_2010$"XCRACE20"<-gsub('"', "", db_2010$"XCRACE20")
db_2010$"XCRACE21"<-gsub('"', "", db_2010$"XCRACE21")
db_2010$"XCRACE22"<-gsub('"', "", db_2010$"XCRACE22")
db_2010$"XCTOTALM"<-gsub('"', "", db_2010$"XCTOTALM")
db_2010$"XCTOTALT"<-gsub('"', "", db_2010$"XCTOTALT")
db_2010$"XCTOTALW"<-gsub('"', "", db_2010$"XCTOTALW")
db_2010$"XCUNKNM"<-gsub('"', "", db_2010$"XCUNKNM")
db_2010$"XCUNKNT"<-gsub('"', "", db_2010$"XCUNKNT")
db_2010$"XCUNKNW"<-gsub('"', "", db_2010$"XCUNKNW")
db_2010$"XCWHITM"<-gsub('"', "", db_2010$"XCWHITM")
db_2010$"XCWHITT"<-gsub('"', "", db_2010$"XCWHITT")
db_2010$"XCWHITW"<-gsub('"', "", db_2010$"XCWHITW")
db_2010$"XDVCAIM"<-gsub('"', "", db_2010$"XDVCAIM")
db_2010$"XDVCAIT"<-gsub('"', "", db_2010$"XDVCAIT")
db_2010$"XDVCAIW"<-gsub('"', "", db_2010$"XDVCAIW")
db_2010$"XDVCAPM"<-gsub('"', "", db_2010$"XDVCAPM")
db_2010$"XDVCAPT"<-gsub('"', "", db_2010$"XDVCAPT")
db_2010$"XDVCAPW"<-gsub('"', "", db_2010$"XDVCAPW")
db_2010$"XDVCBKM"<-gsub('"', "", db_2010$"XDVCBKM")
db_2010$"XDVCBKT"<-gsub('"', "", db_2010$"XDVCBKT")
db_2010$"XDVCBKW"<-gsub('"', "", db_2010$"XDVCBKW")
db_2010$"XDVCHSM"<-gsub('"', "", db_2010$"XDVCHSM")
db_2010$"XDVCHST"<-gsub('"', "", db_2010$"XDVCHST")
db_2010$"XDVCHSW"<-gsub('"', "", db_2010$"XDVCHSW")
db_2010$"XDVCWHM"<-gsub('"', "", db_2010$"XDVCWHM")
db_2010$"XDVCWHT"<-gsub('"', "", db_2010$"XDVCWHT")
db_2010$"XDVCWHW"<-gsub('"', "", db_2010$"XDVCWHW")
#2011
db_2011$"XC2MORM"<-gsub('"', "", db_2011$"XC2MORM")
db_2011$"XC2MORT"<-gsub('"', "", db_2011$"XC2MORT")
db_2011$"XC2MORW"<-gsub('"', "", db_2011$"XC2MORW")
db_2011$"XCAIANM"<-gsub('"', "", db_2011$"XCAIANM")
db_2011$"XCAIANT"<-gsub('"', "", db_2011$"XCAIANT")
db_2011$"XCAIANW"<-gsub('"', "", db_2011$"XCAIANW")
db_2011$"XCASIAM"<-gsub('"', "", db_2011$"XCASIAM")
db_2011$"XCASIAT"<-gsub('"', "", db_2011$"XCASIAT")
db_2011$"XCASIAW"<-gsub('"', "", db_2011$"XCASIAW")
db_2011$"XCBKAAM"<-gsub('"', "", db_2011$"XCBKAAM")
db_2011$"XCBKAAT"<-gsub('"', "", db_2011$"XCBKAAT")
db_2011$"XCBKAAW"<-gsub('"', "", db_2011$"XCBKAAW")
db_2011$"XCHISPM"<-gsub('"', "", db_2011$"XCHISPM")
db_2011$"XCHISPT"<-gsub('"', "", db_2011$"XCHISPT")
db_2011$"XCHISPW"<-gsub('"', "", db_2011$"XCHISPW")
db_2011$"XCNHPIM"<-gsub('"', "", db_2011$"XCNHPIM")
db_2011$"XCNHPIT"<-gsub('"', "", db_2011$"XCNHPIT")
db_2011$"XCNHPIW"<-gsub('"', "", db_2011$"XCNHPIW")
db_2011$"XCNRALM"<-gsub('"', "", db_2011$"XCNRALM")
db_2011$"XCNRALT"<-gsub('"', "", db_2011$"XCNRALT")
db_2011$"XCNRALW"<-gsub('"', "", db_2011$"XCNRALW")
db_2011$"XCTOTALM"<-gsub('"', "", db_2011$"XCTOTALM")
db_2011$"XCTOTALT"<-gsub('"', "", db_2011$"XCTOTALT")
db_2011$"XCTOTALW"<-gsub('"', "", db_2011$"XCTOTALW")
db_2011$"XCUNKNM"<-gsub('"', "", db_2011$"XCUNKNM")
db_2011$"XCUNKNT"<-gsub('"', "", db_2011$"XCUNKNT")
db_2011$"XCUNKNW"<-gsub('"', "", db_2011$"XCUNKNW")
db_2011$"XCWHITM"<-gsub('"', "", db_2011$"XCWHITM")
db_2011$"XCWHITT"<-gsub('"', "", db_2011$"XCWHITT")
db_2011$"XCWHITW"<-gsub('"', "", db_2011$"XCWHITW")
#2012
db_2012$"XC2MORM"<-gsub('"', "", db_2012$"XC2MORM")
db_2012$"XC2MORT"<-gsub('"', "", db_2012$"XC2MORT")
db_2012$"XC2MORW"<-gsub('"', "", db_2012$"XC2MORW")
db_2012$"XCAIANM"<-gsub('"', "", db_2012$"XCAIANM")
db_2012$"XCAIANT"<-gsub('"', "", db_2012$"XCAIANT")
db_2012$"XCAIANW"<-gsub('"', "", db_2012$"XCAIANW")
db_2012$"XCASIAM"<-gsub('"', "", db_2012$"XCASIAM")
db_2012$"XCASIAT"<-gsub('"', "", db_2012$"XCASIAT")
db_2012$"XCASIAW"<-gsub('"', "", db_2012$"XCASIAW")
db_2012$"XCBKAAM"<-gsub('"', "", db_2012$"XCBKAAM")
db_2012$"XCBKAAT"<-gsub('"', "", db_2012$"XCBKAAT")
db_2012$"XCBKAAW"<-gsub('"', "", db_2012$"XCBKAAW")
db_2012$"XCHISPM"<-gsub('"', "", db_2012$"XCHISPM")
db_2012$"XCHISPT"<-gsub('"', "", db_2012$"XCHISPT")
db_2012$"XCHISPW"<-gsub('"', "", db_2012$"XCHISPW")
db_2012$"XCNHPIM"<-gsub('"', "", db_2012$"XCNHPIM")
db_2012$"XCNHPIT"<-gsub('"', "", db_2012$"XCNHPIT")
db_2012$"XCNHPIW"<-gsub('"', "", db_2012$"XCNHPIW")
db_2012$"XCNRALM"<-gsub('"', "", db_2012$"XCNRALM")
db_2012$"XCNRALT"<-gsub('"', "", db_2012$"XCNRALT")
db_2012$"XCNRALW"<-gsub('"', "", db_2012$"XCNRALW")
db_2012$"XCTOTALM"<-gsub('"', "", db_2012$"XCTOTALM")
db_2012$"XCTOTALT"<-gsub('"', "", db_2012$"XCTOTALT")
db_2012$"XCTOTALW"<-gsub('"', "", db_2012$"XCTOTALW")
db_2012$"XCUNKNM"<-gsub('"', "", db_2012$"XCUNKNM")
db_2012$"XCUNKNT"<-gsub('"', "", db_2012$"XCUNKNT")
db_2012$"XCUNKNW"<-gsub('"', "", db_2012$"XCUNKNW")
db_2012$"XCWHITM"<-gsub('"', "", db_2012$"XCWHITM")
db_2012$"XCWHITT"<-gsub('"', "", db_2012$"XCWHITT")
db_2012$"XCWHITW"<-gsub('"', "", db_2012$"XCWHITW")
#2013
db_2013$"XC2MORM"<-gsub('"', "", db_2013$"XC2MORM")
db_2013$"XC2MORT"<-gsub('"', "", db_2013$"XC2MORT")
db_2013$"XC2MORW"<-gsub('"', "", db_2013$"XC2MORW")
db_2013$"XCAIANM"<-gsub('"', "", db_2013$"XCAIANM")
db_2013$"XCAIANT"<-gsub('"', "", db_2013$"XCAIANT")
db_2013$"XCAIANW"<-gsub('"', "", db_2013$"XCAIANW")
db_2013$"XCASIAM"<-gsub('"', "", db_2013$"XCASIAM")
db_2013$"XCASIAT"<-gsub('"', "", db_2013$"XCASIAT")
db_2013$"XCASIAW"<-gsub('"', "", db_2013$"XCASIAW")
db_2013$"XCBKAAM"<-gsub('"', "", db_2013$"XCBKAAM")
db_2013$"XCBKAAT"<-gsub('"', "", db_2013$"XCBKAAT")
db_2013$"XCBKAAW"<-gsub('"', "", db_2013$"XCBKAAW")
db_2013$"XCHISPM"<-gsub('"', "", db_2013$"XCHISPM")
db_2013$"XCHISPT"<-gsub('"', "", db_2013$"XCHISPT")
db_2013$"XCHISPW"<-gsub('"', "", db_2013$"XCHISPW")
db_2013$"XCNHPIM"<-gsub('"', "", db_2013$"XCNHPIM")
db_2013$"XCNHPIT"<-gsub('"', "", db_2013$"XCNHPIT")
db_2013$"XCNHPIW"<-gsub('"', "", db_2013$"XCNHPIW")
db_2013$"XCNRALM"<-gsub('"', "", db_2013$"XCNRALM")
db_2013$"XCNRALT"<-gsub('"', "", db_2013$"XCNRALT")
db_2013$"XCNRALW"<-gsub('"', "", db_2013$"XCNRALW")
db_2013$"XCTOTALM"<-gsub('"', "", db_2013$"XCTOTALM")
db_2013$"XCTOTALT"<-gsub('"', "", db_2013$"XCTOTALT")
db_2013$"XCTOTALW"<-gsub('"', "", db_2013$"XCTOTALW")
db_2013$"XCUNKNM"<-gsub('"', "", db_2013$"XCUNKNM")
db_2013$"XCUNKNT"<-gsub('"', "", db_2013$"XCUNKNT")
db_2013$"XCUNKNW"<-gsub('"', "", db_2013$"XCUNKNW")
db_2013$"XCWHITM"<-gsub('"', "", db_2013$"XCWHITM")
db_2013$"XCWHITT"<-gsub('"', "", db_2013$"XCWHITT")
db_2013$"XCWHITW"<-gsub('"', "", db_2013$"XCWHITW")
#2014
db_2014$"XC2MORM"<-gsub('"', "", db_2014$"XC2MORM")
db_2014$"XC2MORT"<-gsub('"', "", db_2014$"XC2MORT")
db_2014$"XC2MORW"<-gsub('"', "", db_2014$"XC2MORW")
db_2014$"XCAIANM"<-gsub('"', "", db_2014$"XCAIANM")
db_2014$"XCAIANT"<-gsub('"', "", db_2014$"XCAIANT")
db_2014$"XCAIANW"<-gsub('"', "", db_2014$"XCAIANW")
db_2014$"XCASIAM"<-gsub('"', "", db_2014$"XCASIAM")
db_2014$"XCASIAT"<-gsub('"', "", db_2014$"XCASIAT")
db_2014$"XCASIAW"<-gsub('"', "", db_2014$"XCASIAW")
db_2014$"XCBKAAM"<-gsub('"', "", db_2014$"XCBKAAM")
db_2014$"XCBKAAT"<-gsub('"', "", db_2014$"XCBKAAT")
db_2014$"XCBKAAW"<-gsub('"', "", db_2014$"XCBKAAW")
db_2014$"XCHISPM"<-gsub('"', "", db_2014$"XCHISPM")
db_2014$"XCHISPT"<-gsub('"', "", db_2014$"XCHISPT")
db_2014$"XCHISPW"<-gsub('"', "", db_2014$"XCHISPW")
db_2014$"XCNHPIM"<-gsub('"', "", db_2014$"XCNHPIM")
db_2014$"XCNHPIT"<-gsub('"', "", db_2014$"XCNHPIT")
db_2014$"XCNHPIW"<-gsub('"', "", db_2014$"XCNHPIW")
db_2014$"XCNRALM"<-gsub('"', "", db_2014$"XCNRALM")
db_2014$"XCNRALT"<-gsub('"', "", db_2014$"XCNRALT")
db_2014$"XCNRALW"<-gsub('"', "", db_2014$"XCNRALW")
db_2014$"XCTOTALM"<-gsub('"', "", db_2014$"XCTOTALM")
db_2014$"XCTOTALT"<-gsub('"', "", db_2014$"XCTOTALT")
db_2014$"XCTOTALW"<-gsub('"', "", db_2014$"XCTOTALW")
db_2014$"XCUNKNM"<-gsub('"', "", db_2014$"XCUNKNM")
db_2014$"XCUNKNT"<-gsub('"', "", db_2014$"XCUNKNT")
db_2014$"XCUNKNW"<-gsub('"', "", db_2014$"XCUNKNW")
db_2014$"XCWHITM"<-gsub('"', "", db_2014$"XCWHITM")
db_2014$"XCWHITT"<-gsub('"', "", db_2014$"XCWHITT")
db_2014$"XCWHITW"<-gsub('"', "", db_2014$"XCWHITW")
#2015
db_2015$"XC2MORM"<-gsub('"', "", db_2015$"XC2MORM")
db_2015$"XC2MORT"<-gsub('"', "", db_2015$"XC2MORT")
db_2015$"XC2MORW"<-gsub('"', "", db_2015$"XC2MORW")
db_2015$"XCAIANM"<-gsub('"', "", db_2015$"XCAIANM")
db_2015$"XCAIANT"<-gsub('"', "", db_2015$"XCAIANT")
db_2015$"XCAIANW"<-gsub('"', "", db_2015$"XCAIANW")
db_2015$"XCASIAM"<-gsub('"', "", db_2015$"XCASIAM")
db_2015$"XCASIAT"<-gsub('"', "", db_2015$"XCASIAT")
db_2015$"XCASIAW"<-gsub('"', "", db_2015$"XCASIAW")
db_2015$"XCBKAAM"<-gsub('"', "", db_2015$"XCBKAAM")
db_2015$"XCBKAAT"<-gsub('"', "", db_2015$"XCBKAAT")
db_2015$"XCBKAAW"<-gsub('"', "", db_2015$"XCBKAAW")
db_2015$"XCHISPM"<-gsub('"', "", db_2015$"XCHISPM")
db_2015$"XCHISPT"<-gsub('"', "", db_2015$"XCHISPT")
db_2015$"XCHISPW"<-gsub('"', "", db_2015$"XCHISPW")
db_2015$"XCNHPIM"<-gsub('"', "", db_2015$"XCNHPIM")
db_2015$"XCNHPIT"<-gsub('"', "", db_2015$"XCNHPIT")
db_2015$"XCNHPIW"<-gsub('"', "", db_2015$"XCNHPIW")
db_2015$"XCNRALM"<-gsub('"', "", db_2015$"XCNRALM")
db_2015$"XCNRALT"<-gsub('"', "", db_2015$"XCNRALT")
db_2015$"XCNRALW"<-gsub('"', "", db_2015$"XCNRALW")
db_2015$"XCTOTALM"<-gsub('"', "", db_2015$"XCTOTALM")
db_2015$"XCTOTALT"<-gsub('"', "", db_2015$"XCTOTALT")
db_2015$"XCTOTALW"<-gsub('"', "", db_2015$"XCTOTALW")
db_2015$"XCUNKNM"<-gsub('"', "", db_2015$"XCUNKNM")
db_2015$"XCUNKNT"<-gsub('"', "", db_2015$"XCUNKNT")
db_2015$"XCUNKNW"<-gsub('"', "", db_2015$"XCUNKNW")
db_2015$"XCWHITM"<-gsub('"', "", db_2015$"XCWHITM")
db_2015$"XCWHITT"<-gsub('"', "", db_2015$"XCWHITT")
db_2015$"XCWHITW"<-gsub('"', "", db_2015$"XCWHITW")
#2016
db_2016$"XC2MORM"<-gsub('"', "", db_2016$"XC2MORM")
db_2016$"XC2MORT"<-gsub('"', "", db_2016$"XC2MORT")
db_2016$"XC2MORW"<-gsub('"', "", db_2016$"XC2MORW")
db_2016$"XCAIANM"<-gsub('"', "", db_2016$"XCAIANM")
db_2016$"XCAIANT"<-gsub('"', "", db_2016$"XCAIANT")
db_2016$"XCAIANW"<-gsub('"', "", db_2016$"XCAIANW")
db_2016$"XCASIAM"<-gsub('"', "", db_2016$"XCASIAM")
db_2016$"XCASIAT"<-gsub('"', "", db_2016$"XCASIAT")
db_2016$"XCASIAW"<-gsub('"', "", db_2016$"XCASIAW")
db_2016$"XCBKAAM"<-gsub('"', "", db_2016$"XCBKAAM")
db_2016$"XCBKAAT"<-gsub('"', "", db_2016$"XCBKAAT")
db_2016$"XCBKAAW"<-gsub('"', "", db_2016$"XCBKAAW")
db_2016$"XCHISPM"<-gsub('"', "", db_2016$"XCHISPM")
db_2016$"XCHISPT"<-gsub('"', "", db_2016$"XCHISPT")
db_2016$"XCHISPW"<-gsub('"', "", db_2016$"XCHISPW")
db_2016$"XCNHPIM"<-gsub('"', "", db_2016$"XCNHPIM")
db_2016$"XCNHPIT"<-gsub('"', "", db_2016$"XCNHPIT")
db_2016$"XCNHPIW"<-gsub('"', "", db_2016$"XCNHPIW")
db_2016$"XCNRALM"<-gsub('"', "", db_2016$"XCNRALM")
db_2016$"XCNRALT"<-gsub('"', "", db_2016$"XCNRALT")
db_2016$"XCNRALW"<-gsub('"', "", db_2016$"XCNRALW")
db_2016$"XCTOTALM"<-gsub('"', "", db_2016$"XCTOTALM")
db_2016$"XCTOTALT"<-gsub('"', "", db_2016$"XCTOTALT")
db_2016$"XCTOTALW"<-gsub('"', "", db_2016$"XCTOTALW")
db_2016$"XCUNKNM"<-gsub('"', "", db_2016$"XCUNKNM")
db_2016$"XCUNKNT"<-gsub('"', "", db_2016$"XCUNKNT")
db_2016$"XCUNKNW"<-gsub('"', "", db_2016$"XCUNKNW")
db_2016$"XCWHITM"<-gsub('"', "", db_2016$"XCWHITM")
db_2016$"XCWHITT"<-gsub('"', "", db_2016$"XCWHITT")
db_2016$"XCWHITW"<-gsub('"', "", db_2016$"XCWHITW")
#2017
db_2017$"XC2MORM"<-gsub('"', "", db_2017$"XC2MORM")
db_2017$"XC2MORT"<-gsub('"', "", db_2017$"XC2MORT")
db_2017$"XC2MORW"<-gsub('"', "", db_2017$"XC2MORW")
db_2017$"XCAIANM"<-gsub('"', "", db_2017$"XCAIANM")
db_2017$"XCAIANT"<-gsub('"', "", db_2017$"XCAIANT")
db_2017$"XCAIANW"<-gsub('"', "", db_2017$"XCAIANW")
db_2017$"XCASIAM"<-gsub('"', "", db_2017$"XCASIAM")
db_2017$"XCASIAT"<-gsub('"', "", db_2017$"XCASIAT")
db_2017$"XCASIAW"<-gsub('"', "", db_2017$"XCASIAW")
db_2017$"XCBKAAM"<-gsub('"', "", db_2017$"XCBKAAM")
db_2017$"XCBKAAT"<-gsub('"', "", db_2017$"XCBKAAT")
db_2017$"XCBKAAW"<-gsub('"', "", db_2017$"XCBKAAW")
db_2017$"XCHISPM"<-gsub('"', "", db_2017$"XCHISPM")
db_2017$"XCHISPT"<-gsub('"', "", db_2017$"XCHISPT")
db_2017$"XCHISPW"<-gsub('"', "", db_2017$"XCHISPW")
db_2017$"XCNHPIM"<-gsub('"', "", db_2017$"XCNHPIM")
db_2017$"XCNHPIT"<-gsub('"', "", db_2017$"XCNHPIT")
db_2017$"XCNHPIW"<-gsub('"', "", db_2017$"XCNHPIW")
db_2017$"XCNRALM"<-gsub('"', "", db_2017$"XCNRALM")
db_2017$"XCNRALT"<-gsub('"', "", db_2017$"XCNRALT")
db_2017$"XCNRALW"<-gsub('"', "", db_2017$"XCNRALW")
db_2017$"XCTOTALM"<-gsub('"', "", db_2017$"XCTOTALM")
db_2017$"XCTOTALT"<-gsub('"', "", db_2017$"XCTOTALT")
db_2017$"XCTOTALW"<-gsub('"', "", db_2017$"XCTOTALW")
db_2017$"XCUNKNM"<-gsub('"', "", db_2017$"XCUNKNM")
db_2017$"XCUNKNT"<-gsub('"', "", db_2017$"XCUNKNT")
db_2017$"XCUNKNW"<-gsub('"', "", db_2017$"XCUNKNW")
db_2017$"XCWHITM"<-gsub('"', "", db_2017$"XCWHITM")
db_2017$"XCWHITT"<-gsub('"', "", db_2017$"XCWHITT")
db_2017$"XCWHITW"<-gsub('"', "", db_2017$"XCWHITW")
#Order source data table
source_2010 <- source_2010[order(source_2010$"UNITID",source_2010$"CIPCODE",source_2010$"MAJORNUM",source_2010$"AWLEVEL",source_2010$"XCNRALM",source_2010$"CNRALM",source_2010$"XCNRALW",source_2010$"CNRALW",source_2010$"XCRACE03",source_2010$"CRACE03",source_2010$"XCRACE04",source_2010$"CRACE04",source_2010$"XCRACE05",source_2010$"CRACE05",source_2010$"XCRACE06",source_2010$"CRACE06",source_2010$"XCRACE07",source_2010$"CRACE07",source_2010$"XCRACE08",source_2010$"CRACE08",source_2010$"XCRACE09",source_2010$"CRACE09",source_2010$"XCRACE10",source_2010$"CRACE10",source_2010$"XCRACE11",source_2010$"CRACE11",source_2010$"XCRACE12",source_2010$"CRACE12",source_2010$"XCUNKNM",source_2010$"CUNKNM",source_2010$"XCUNKNW",source_2010$"CUNKNW",source_2010$"XCTOTALM",source_2010$"CTOTALM",source_2010$"XCTOTALW",source_2010$"CTOTALW",source_2010$"XCNRALT",source_2010$"CNRALT",source_2010$"XCRACE18",source_2010$"CRACE18",source_2010$"XCRACE19",source_2010$"CRACE19",source_2010$"XCRACE20",source_2010$"CRACE20",source_2010$"XCRACE21",source_2010$"CRACE21",source_2010$"XCRACE22",source_2010$"CRACE22",source_2010$"XCUNKNT",source_2010$"CUNKNT",source_2010$"XCTOTALT",source_2010$"CTOTALT",source_2010$"XCHISPM",source_2010$"CHISPM",source_2010$"XCHISPW",source_2010$"CHISPW",source_2010$"XCAIANM",source_2010$"CAIANM",source_2010$"XCAIANW",source_2010$"CAIANW",source_2010$"XCASIAM",source_2010$"CASIAM",source_2010$"XCASIAW",source_2010$"CASIAW",source_2010$"XCBKAAM",source_2010$"CBKAAM",source_2010$"XCBKAAW",source_2010$"CBKAAW",source_2010$"XCNHPIM",source_2010$"CNHPIM",source_2010$"XCNHPIW",source_2010$"CNHPIW",source_2010$"XCWHITM",source_2010$"CWHITM",source_2010$"XCWHITW",source_2010$"CWHITW",source_2010$"XC2MORM",source_2010$"C2MORM",source_2010$"XC2MORW",source_2010$"C2MORW",source_2010$"XCHISPT",source_2010$"CHISPT",source_2010$"XCAIANT",source_2010$"CAIANT",source_2010$"XCASIAT",source_2010$"CASIAT",source_2010$"XCBKAAT",source_2010$"CBKAAT",source_2010$"XCNHPIT",source_2010$"CNHPIT",source_2010$"XCWHITT",source_2010$"CWHITT",source_2010$"XC2MORT",source_2010$"C2MORT",source_2010$"XDVCAIT",source_2010$"DVCAIT",source_2010$"XDVCAIM",source_2010$"DVCAIM",source_2010$"XDVCAIW",source_2010$"DVCAIW",source_2010$"XDVCAPT",source_2010$"DVCAPT",source_2010$"XDVCAPM",source_2010$"DVCAPM",source_2010$"XDVCAPW",source_2010$"DVCAPW",source_2010$"XDVCBKT",source_2010$"DVCBKT",source_2010$"XDVCBKM",source_2010$"DVCBKM",source_2010$"XDVCBKW",source_2010$"DVCBKW",source_2010$"XDVCHST",source_2010$"DVCHST",source_2010$"XDVCHSM",source_2010$"DVCHSM",source_2010$"XDVCHSW",source_2010$"DVCHSW",source_2010$"XDVCWHT",source_2010$"DVCWHT",source_2010$"XDVCWHM",source_2010$"DVCWHM",source_2010$"XDVCWHW",source_2010$"DVCWHW"),]
source_2011 <- source_2011[order(source_2011$"UNITID",source_2011$"CIPCODE",source_2011$"MAJORNUM",source_2011$"AWLEVEL",source_2011$"XCTOTALT",source_2011$"CTOTALT",source_2011$"XCTOTALM",source_2011$"CTOTALM",source_2011$"XCTOTALW",source_2011$"CTOTALW",source_2011$"XCAIANT",source_2011$"CAIANT",source_2011$"XCAIANM",source_2011$"CAIANM",source_2011$"XCAIANW",source_2011$"CAIANW",source_2011$"XCASIAT",source_2011$"CASIAT",source_2011$"XCASIAM",source_2011$"CASIAM",source_2011$"XCASIAW",source_2011$"CASIAW",source_2011$"XCBKAAT",source_2011$"CBKAAT",source_2011$"XCBKAAM",source_2011$"CBKAAM",source_2011$"XCBKAAW",source_2011$"CBKAAW",source_2011$"XCHISPT",source_2011$"CHISPT",source_2011$"XCHISPM",source_2011$"CHISPM",source_2011$"XCHISPW",source_2011$"CHISPW",source_2011$"XCNHPIT",source_2011$"CNHPIT",source_2011$"XCNHPIM",source_2011$"CNHPIM",source_2011$"XCNHPIW",source_2011$"CNHPIW",source_2011$"XCWHITT",source_2011$"CWHITT",source_2011$"XCWHITM",source_2011$"CWHITM",source_2011$"XCWHITW",source_2011$"CWHITW",source_2011$"XC2MORT",source_2011$"C2MORT",source_2011$"XC2MORM",source_2011$"C2MORM",source_2011$"XC2MORW",source_2011$"C2MORW",source_2011$"XCUNKNT",source_2011$"CUNKNT",source_2011$"XCUNKNM",source_2011$"CUNKNM",source_2011$"XCUNKNW",source_2011$"CUNKNW",source_2011$"XCNRALT",source_2011$"CNRALT",source_2011$"XCNRALM",source_2011$"CNRALM",source_2011$"XCNRALW",source_2011$"CNRALW"),]
source_2012 <- source_2012[order(source_2012$"UNITID",source_2012$"CIPCODE",source_2012$"MAJORNUM",source_2012$"AWLEVEL",source_2012$"CDISTEDP",source_2012$"XCTOTALT",source_2012$"CTOTALT",source_2012$"XCTOTALM",source_2012$"CTOTALM",source_2012$"XCTOTALW",source_2012$"CTOTALW",source_2012$"XCAIANT",source_2012$"CAIANT",source_2012$"XCAIANM",source_2012$"CAIANM",source_2012$"XCAIANW",source_2012$"CAIANW",source_2012$"XCASIAT",source_2012$"CASIAT",source_2012$"XCASIAM",source_2012$"CASIAM",source_2012$"XCASIAW",source_2012$"CASIAW",source_2012$"XCBKAAT",source_2012$"CBKAAT",source_2012$"XCBKAAM",source_2012$"CBKAAM",source_2012$"XCBKAAW",source_2012$"CBKAAW",source_2012$"XCHISPT",source_2012$"CHISPT",source_2012$"XCHISPM",source_2012$"CHISPM",source_2012$"XCHISPW",source_2012$"CHISPW",source_2012$"XCNHPIT",source_2012$"CNHPIT",source_2012$"XCNHPIM",source_2012$"CNHPIM",source_2012$"XCNHPIW",source_2012$"CNHPIW",source_2012$"XCWHITT",source_2012$"CWHITT",source_2012$"XCWHITM",source_2012$"CWHITM",source_2012$"XCWHITW",source_2012$"CWHITW",source_2012$"XC2MORT",source_2012$"C2MORT",source_2012$"XC2MORM",source_2012$"C2MORM",source_2012$"XC2MORW",source_2012$"C2MORW",source_2012$"XCUNKNT",source_2012$"CUNKNT",source_2012$"XCUNKNM",source_2012$"CUNKNM",source_2012$"XCUNKNW",source_2012$"CUNKNW",source_2012$"XCNRALT",source_2012$"CNRALT",source_2012$"XCNRALM",source_2012$"CNRALM",source_2012$"XCNRALW",source_2012$"CNRALW"),]
source_2013 <- source_2013[order(source_2013$"UNITID",source_2013$"CIPCODE",source_2013$"MAJORNUM",source_2013$"AWLEVEL",source_2013$"XCTOTALT",source_2013$"CTOTALT",source_2013$"XCTOTALM",source_2013$"CTOTALM",source_2013$"XCTOTALW",source_2013$"CTOTALW",source_2013$"XCAIANT",source_2013$"CAIANT",source_2013$"XCAIANM",source_2013$"CAIANM",source_2013$"XCAIANW",source_2013$"CAIANW",source_2013$"XCASIAT",source_2013$"CASIAT",source_2013$"XCASIAM",source_2013$"CASIAM",source_2013$"XCASIAW",source_2013$"CASIAW",source_2013$"XCBKAAT",source_2013$"CBKAAT",source_2013$"XCBKAAM",source_2013$"CBKAAM",source_2013$"XCBKAAW",source_2013$"CBKAAW",source_2013$"XCHISPT",source_2013$"CHISPT",source_2013$"XCHISPM",source_2013$"CHISPM",source_2013$"XCHISPW",source_2013$"CHISPW",source_2013$"XCNHPIT",source_2013$"CNHPIT",source_2013$"XCNHPIM",source_2013$"CNHPIM",source_2013$"XCNHPIW",source_2013$"CNHPIW",source_2013$"XCWHITT",source_2013$"CWHITT",source_2013$"XCWHITM",source_2013$"CWHITM",source_2013$"XCWHITW",source_2013$"CWHITW",source_2013$"XC2MORT",source_2013$"C2MORT",source_2013$"XC2MORM",source_2013$"C2MORM",source_2013$"XC2MORW",source_2013$"C2MORW",source_2013$"XCUNKNT",source_2013$"CUNKNT",source_2013$"XCUNKNM",source_2013$"CUNKNM",source_2013$"XCUNKNW",source_2013$"CUNKNW",source_2013$"XCNRALT",source_2013$"CNRALT",source_2013$"XCNRALM",source_2013$"CNRALM",source_2013$"XCNRALW",source_2013$"CNRALW"),]
source_2014 <- source_2014[order(source_2014$"UNITID",source_2014$"CIPCODE",source_2014$"MAJORNUM",source_2014$"AWLEVEL",source_2014$"XCTOTALT",source_2014$"CTOTALT",source_2014$"XCTOTALM",source_2014$"CTOTALM",source_2014$"XCTOTALW",source_2014$"CTOTALW",source_2014$"XCAIANT",source_2014$"CAIANT",source_2014$"XCAIANM",source_2014$"CAIANM",source_2014$"XCAIANW",source_2014$"CAIANW",source_2014$"XCASIAT",source_2014$"CASIAT",source_2014$"XCASIAM",source_2014$"CASIAM",source_2014$"XCASIAW",source_2014$"CASIAW",source_2014$"XCBKAAT",source_2014$"CBKAAT",source_2014$"XCBKAAM",source_2014$"CBKAAM",source_2014$"XCBKAAW",source_2014$"CBKAAW",source_2014$"XCHISPT",source_2014$"CHISPT",source_2014$"XCHISPM",source_2014$"CHISPM",source_2014$"XCHISPW",source_2014$"CHISPW",source_2014$"XCNHPIT",source_2014$"CNHPIT",source_2014$"XCNHPIM",source_2014$"CNHPIM",source_2014$"XCNHPIW",source_2014$"CNHPIW",source_2014$"XCWHITT",source_2014$"CWHITT",source_2014$"XCWHITM",source_2014$"CWHITM",source_2014$"XCWHITW",source_2014$"CWHITW",source_2014$"XC2MORT",source_2014$"C2MORT",source_2014$"XC2MORM",source_2014$"C2MORM",source_2014$"XC2MORW",source_2014$"C2MORW",source_2014$"XCUNKNT",source_2014$"CUNKNT",source_2014$"XCUNKNM",source_2014$"CUNKNM",source_2014$"XCUNKNW",source_2014$"CUNKNW",source_2014$"XCNRALT",source_2014$"CNRALT",source_2014$"XCNRALM",source_2014$"CNRALM",source_2014$"XCNRALW",source_2014$"CNRALW"),]
source_2015 <- source_2015[order(source_2015$"UNITID",source_2015$"CIPCODE",source_2015$"MAJORNUM",source_2015$"AWLEVEL",source_2015$"XCTOTALT",source_2015$"CTOTALT",source_2015$"XCTOTALM",source_2015$"CTOTALM",source_2015$"XCTOTALW",source_2015$"CTOTALW",source_2015$"XCAIANT",source_2015$"CAIANT",source_2015$"XCAIANM",source_2015$"CAIANM",source_2015$"XCAIANW",source_2015$"CAIANW",source_2015$"XCASIAT",source_2015$"CASIAT",source_2015$"XCASIAM",source_2015$"CASIAM",source_2015$"XCASIAW",source_2015$"CASIAW",source_2015$"XCBKAAT",source_2015$"CBKAAT",source_2015$"XCBKAAM",source_2015$"CBKAAM",source_2015$"XCBKAAW",source_2015$"CBKAAW",source_2015$"XCHISPT",source_2015$"CHISPT",source_2015$"XCHISPM",source_2015$"CHISPM",source_2015$"XCHISPW",source_2015$"CHISPW",source_2015$"XCNHPIT",source_2015$"CNHPIT",source_2015$"XCNHPIM",source_2015$"CNHPIM",source_2015$"XCNHPIW",source_2015$"CNHPIW",source_2015$"XCWHITT",source_2015$"CWHITT",source_2015$"XCWHITM",source_2015$"CWHITM",source_2015$"XCWHITW",source_2015$"CWHITW",source_2015$"XC2MORT",source_2015$"C2MORT",source_2015$"XC2MORM",source_2015$"C2MORM",source_2015$"XC2MORW",source_2015$"C2MORW",source_2015$"XCUNKNT",source_2015$"CUNKNT",source_2015$"XCUNKNM",source_2015$"CUNKNM",source_2015$"XCUNKNW",source_2015$"CUNKNW",source_2015$"XCNRALT",source_2015$"CNRALT",source_2015$"XCNRALM",source_2015$"CNRALM",source_2015$"XCNRALW",source_2015$"CNRALW"),]
source_2016 <- source_2016[order(source_2016$"UNITID",source_2016$"CIPCODE",source_2016$"MAJORNUM",source_2016$"AWLEVEL",source_2016$"XCTOTALT",source_2016$"CTOTALT",source_2016$"XCTOTALM",source_2016$"CTOTALM",source_2016$"XCTOTALW",source_2016$"CTOTALW",source_2016$"XCAIANT",source_2016$"CAIANT",source_2016$"XCAIANM",source_2016$"CAIANM",source_2016$"XCAIANW",source_2016$"CAIANW",source_2016$"XCASIAT",source_2016$"CASIAT",source_2016$"XCASIAM",source_2016$"CASIAM",source_2016$"XCASIAW",source_2016$"CASIAW",source_2016$"XCBKAAT",source_2016$"CBKAAT",source_2016$"XCBKAAM",source_2016$"CBKAAM",source_2016$"XCBKAAW",source_2016$"CBKAAW",source_2016$"XCHISPT",source_2016$"CHISPT",source_2016$"XCHISPM",source_2016$"CHISPM",source_2016$"XCHISPW",source_2016$"CHISPW",source_2016$"XCNHPIT",source_2016$"CNHPIT",source_2016$"XCNHPIM",source_2016$"CNHPIM",source_2016$"XCNHPIW",source_2016$"CNHPIW",source_2016$"XCWHITT",source_2016$"CWHITT",source_2016$"XCWHITM",source_2016$"CWHITM",source_2016$"XCWHITW",source_2016$"CWHITW",source_2016$"XC2MORT",source_2016$"C2MORT",source_2016$"XC2MORM",source_2016$"C2MORM",source_2016$"XC2MORW",source_2016$"C2MORW",source_2016$"XCUNKNT",source_2016$"CUNKNT",source_2016$"XCUNKNM",source_2016$"CUNKNM",source_2016$"XCUNKNW",source_2016$"CUNKNW",source_2016$"XCNRALT",source_2016$"CNRALT",source_2016$"XCNRALM",source_2016$"CNRALM",source_2016$"XCNRALW",source_2016$"CNRALW"),]
source_2017 <- source_2017[order(source_2017$"UNITID",source_2017$"CIPCODE",source_2017$"MAJORNUM",source_2017$"AWLEVEL",source_2017$"XCTOTALT",source_2017$"CTOTALT",source_2017$"XCTOTALM",source_2017$"CTOTALM",source_2017$"XCTOTALW",source_2017$"CTOTALW",source_2017$"XCAIANT",source_2017$"CAIANT",source_2017$"XCAIANM",source_2017$"CAIANM",source_2017$"XCAIANW",source_2017$"CAIANW",source_2017$"XCASIAT",source_2017$"CASIAT",source_2017$"XCASIAM",source_2017$"CASIAM",source_2017$"XCASIAW",source_2017$"CASIAW",source_2017$"XCBKAAT",source_2017$"CBKAAT",source_2017$"XCBKAAM",source_2017$"CBKAAM",source_2017$"XCBKAAW",source_2017$"CBKAAW",source_2017$"XCHISPT",source_2017$"CHISPT",source_2017$"XCHISPM",source_2017$"CHISPM",source_2017$"XCHISPW",source_2017$"CHISPW",source_2017$"XCNHPIT",source_2017$"CNHPIT",source_2017$"XCNHPIM",source_2017$"CNHPIM",source_2017$"XCNHPIW",source_2017$"CNHPIW",source_2017$"XCWHITT",source_2017$"CWHITT",source_2017$"XCWHITM",source_2017$"CWHITM",source_2017$"XCWHITW",source_2017$"CWHITW",source_2017$"XC2MORT",source_2017$"C2MORT",source_2017$"XC2MORM",source_2017$"C2MORM",source_2017$"XC2MORW",source_2017$"C2MORW",source_2017$"XCUNKNT",source_2017$"CUNKNT",source_2017$"XCUNKNM",source_2017$"CUNKNM",source_2017$"XCUNKNW",source_2017$"CUNKNW",source_2017$"XCNRALT",source_2017$"CNRALT",source_2017$"XCNRALM",source_2017$"CNRALM",source_2017$"XCNRALW",source_2017$"CNRALW"),]
#Order database data table
db_2010 <- db_2010[order(db_2010$"UNITID",db_2010$"CIPCODE",db_2010$"MAJORNUM",db_2010$"AWLEVEL",db_2010$"XCNRALM",db_2010$"CNRALM",db_2010$"XCNRALW",db_2010$"CNRALW",db_2010$"XCRACE03",db_2010$"CRACE03",db_2010$"XCRACE04",db_2010$"CRACE04",db_2010$"XCRACE05",db_2010$"CRACE05",db_2010$"XCRACE06",db_2010$"CRACE06",db_2010$"XCRACE07",db_2010$"CRACE07",db_2010$"XCRACE08",db_2010$"CRACE08",db_2010$"XCRACE09",db_2010$"CRACE09",db_2010$"XCRACE10",db_2010$"CRACE10",db_2010$"XCRACE11",db_2010$"CRACE11",db_2010$"XCRACE12",db_2010$"CRACE12",db_2010$"XCUNKNM",db_2010$"CUNKNM",db_2010$"XCUNKNW",db_2010$"CUNKNW",db_2010$"XCTOTALM",db_2010$"CTOTALM",db_2010$"XCTOTALW",db_2010$"CTOTALW",db_2010$"XCNRALT",db_2010$"CNRALT",db_2010$"XCRACE18",db_2010$"CRACE18",db_2010$"XCRACE19",db_2010$"CRACE19",db_2010$"XCRACE20",db_2010$"CRACE20",db_2010$"XCRACE21",db_2010$"CRACE21",db_2010$"XCRACE22",db_2010$"CRACE22",db_2010$"XCUNKNT",db_2010$"CUNKNT",db_2010$"XCTOTALT",db_2010$"CTOTALT",db_2010$"XCHISPM",db_2010$"CHISPM",db_2010$"XCHISPW",db_2010$"CHISPW",db_2010$"XCAIANM",db_2010$"CAIANM",db_2010$"XCAIANW",db_2010$"CAIANW",db_2010$"XCASIAM",db_2010$"CASIAM",db_2010$"XCASIAW",db_2010$"CASIAW",db_2010$"XCBKAAM",db_2010$"CBKAAM",db_2010$"XCBKAAW",db_2010$"CBKAAW",db_2010$"XCNHPIM",db_2010$"CNHPIM",db_2010$"XCNHPIW",db_2010$"CNHPIW",db_2010$"XCWHITM",db_2010$"CWHITM",db_2010$"XCWHITW",db_2010$"CWHITW",db_2010$"XC2MORM",db_2010$"C2MORM",db_2010$"XC2MORW",db_2010$"C2MORW",db_2010$"XCHISPT",db_2010$"CHISPT",db_2010$"XCAIANT",db_2010$"CAIANT",db_2010$"XCASIAT",db_2010$"CASIAT",db_2010$"XCBKAAT",db_2010$"CBKAAT",db_2010$"XCNHPIT",db_2010$"CNHPIT",db_2010$"XCWHITT",db_2010$"CWHITT",db_2010$"XC2MORT",db_2010$"C2MORT",db_2010$"XDVCAIT",db_2010$"DVCAIT",db_2010$"XDVCAIM",db_2010$"DVCAIM",db_2010$"XDVCAIW",db_2010$"DVCAIW",db_2010$"XDVCAPT",db_2010$"DVCAPT",db_2010$"XDVCAPM",db_2010$"DVCAPM",db_2010$"XDVCAPW",db_2010$"DVCAPW",db_2010$"XDVCBKT",db_2010$"DVCBKT",db_2010$"XDVCBKM",db_2010$"DVCBKM",db_2010$"XDVCBKW",db_2010$"DVCBKW",db_2010$"XDVCHST",db_2010$"DVCHST",db_2010$"XDVCHSM",db_2010$"DVCHSM",db_2010$"XDVCHSW",db_2010$"DVCHSW",db_2010$"XDVCWHT",db_2010$"DVCWHT",db_2010$"XDVCWHM",db_2010$"DVCWHM",db_2010$"XDVCWHW",db_2010$"DVCWHW"),]
db_2011 <- db_2011[order(db_2011$"UNITID",db_2011$"CIPCODE",db_2011$"MAJORNUM",db_2011$"AWLEVEL",db_2011$"XCTOTALT",db_2011$"CTOTALT",db_2011$"XCTOTALM",db_2011$"CTOTALM",db_2011$"XCTOTALW",db_2011$"CTOTALW",db_2011$"XCAIANT",db_2011$"CAIANT",db_2011$"XCAIANM",db_2011$"CAIANM",db_2011$"XCAIANW",db_2011$"CAIANW",db_2011$"XCASIAT",db_2011$"CASIAT",db_2011$"XCASIAM",db_2011$"CASIAM",db_2011$"XCASIAW",db_2011$"CASIAW",db_2011$"XCBKAAT",db_2011$"CBKAAT",db_2011$"XCBKAAM",db_2011$"CBKAAM",db_2011$"XCBKAAW",db_2011$"CBKAAW",db_2011$"XCHISPT",db_2011$"CHISPT",db_2011$"XCHISPM",db_2011$"CHISPM",db_2011$"XCHISPW",db_2011$"CHISPW",db_2011$"XCNHPIT",db_2011$"CNHPIT",db_2011$"XCNHPIM",db_2011$"CNHPIM",db_2011$"XCNHPIW",db_2011$"CNHPIW",db_2011$"XCWHITT",db_2011$"CWHITT",db_2011$"XCWHITM",db_2011$"CWHITM",db_2011$"XCWHITW",db_2011$"CWHITW",db_2011$"XC2MORT",db_2011$"C2MORT",db_2011$"XC2MORM",db_2011$"C2MORM",db_2011$"XC2MORW",db_2011$"C2MORW",db_2011$"XCUNKNT",db_2011$"CUNKNT",db_2011$"XCUNKNM",db_2011$"CUNKNM",db_2011$"XCUNKNW",db_2011$"CUNKNW",db_2011$"XCNRALT",db_2011$"CNRALT",db_2011$"XCNRALM",db_2011$"CNRALM",db_2011$"XCNRALW",db_2011$"CNRALW"),]
db_2012 <- db_2012[order(db_2012$"UNITID",db_2012$"CIPCODE",db_2012$"MAJORNUM",db_2012$"AWLEVEL",db_2012$"CDISTEDP",db_2012$"XCTOTALT",db_2012$"CTOTALT",db_2012$"XCTOTALM",db_2012$"CTOTALM",db_2012$"XCTOTALW",db_2012$"CTOTALW",db_2012$"XCAIANT",db_2012$"CAIANT",db_2012$"XCAIANM",db_2012$"CAIANM",db_2012$"XCAIANW",db_2012$"CAIANW",db_2012$"XCASIAT",db_2012$"CASIAT",db_2012$"XCASIAM",db_2012$"CASIAM",db_2012$"XCASIAW",db_2012$"CASIAW",db_2012$"XCBKAAT",db_2012$"CBKAAT",db_2012$"XCBKAAM",db_2012$"CBKAAM",db_2012$"XCBKAAW",db_2012$"CBKAAW",db_2012$"XCHISPT",db_2012$"CHISPT",db_2012$"XCHISPM",db_2012$"CHISPM",db_2012$"XCHISPW",db_2012$"CHISPW",db_2012$"XCNHPIT",db_2012$"CNHPIT",db_2012$"XCNHPIM",db_2012$"CNHPIM",db_2012$"XCNHPIW",db_2012$"CNHPIW",db_2012$"XCWHITT",db_2012$"CWHITT",db_2012$"XCWHITM",db_2012$"CWHITM",db_2012$"XCWHITW",db_2012$"CWHITW",db_2012$"XC2MORT",db_2012$"C2MORT",db_2012$"XC2MORM",db_2012$"C2MORM",db_2012$"XC2MORW",db_2012$"C2MORW",db_2012$"XCUNKNT",db_2012$"CUNKNT",db_2012$"XCUNKNM",db_2012$"CUNKNM",db_2012$"XCUNKNW",db_2012$"CUNKNW",db_2012$"XCNRALT",db_2012$"CNRALT",db_2012$"XCNRALM",db_2012$"CNRALM",db_2012$"XCNRALW",db_2012$"CNRALW"),]
db_2013 <- db_2013[order(db_2013$"UNITID",db_2013$"CIPCODE",db_2013$"MAJORNUM",db_2013$"AWLEVEL",db_2013$"XCTOTALT",db_2013$"CTOTALT",db_2013$"XCTOTALM",db_2013$"CTOTALM",db_2013$"XCTOTALW",db_2013$"CTOTALW",db_2013$"XCAIANT",db_2013$"CAIANT",db_2013$"XCAIANM",db_2013$"CAIANM",db_2013$"XCAIANW",db_2013$"CAIANW",db_2013$"XCASIAT",db_2013$"CASIAT",db_2013$"XCASIAM",db_2013$"CASIAM",db_2013$"XCASIAW",db_2013$"CASIAW",db_2013$"XCBKAAT",db_2013$"CBKAAT",db_2013$"XCBKAAM",db_2013$"CBKAAM",db_2013$"XCBKAAW",db_2013$"CBKAAW",db_2013$"XCHISPT",db_2013$"CHISPT",db_2013$"XCHISPM",db_2013$"CHISPM",db_2013$"XCHISPW",db_2013$"CHISPW",db_2013$"XCNHPIT",db_2013$"CNHPIT",db_2013$"XCNHPIM",db_2013$"CNHPIM",db_2013$"XCNHPIW",db_2013$"CNHPIW",db_2013$"XCWHITT",db_2013$"CWHITT",db_2013$"XCWHITM",db_2013$"CWHITM",db_2013$"XCWHITW",db_2013$"CWHITW",db_2013$"XC2MORT",db_2013$"C2MORT",db_2013$"XC2MORM",db_2013$"C2MORM",db_2013$"XC2MORW",db_2013$"C2MORW",db_2013$"XCUNKNT",db_2013$"CUNKNT",db_2013$"XCUNKNM",db_2013$"CUNKNM",db_2013$"XCUNKNW",db_2013$"CUNKNW",db_2013$"XCNRALT",db_2013$"CNRALT",db_2013$"XCNRALM",db_2013$"CNRALM",db_2013$"XCNRALW",db_2013$"CNRALW"),]
db_2014 <- db_2014[order(db_2014$"UNITID",db_2014$"CIPCODE",db_2014$"MAJORNUM",db_2014$"AWLEVEL",db_2014$"XCTOTALT",db_2014$"CTOTALT",db_2014$"XCTOTALM",db_2014$"CTOTALM",db_2014$"XCTOTALW",db_2014$"CTOTALW",db_2014$"XCAIANT",db_2014$"CAIANT",db_2014$"XCAIANM",db_2014$"CAIANM",db_2014$"XCAIANW",db_2014$"CAIANW",db_2014$"XCASIAT",db_2014$"CASIAT",db_2014$"XCASIAM",db_2014$"CASIAM",db_2014$"XCASIAW",db_2014$"CASIAW",db_2014$"XCBKAAT",db_2014$"CBKAAT",db_2014$"XCBKAAM",db_2014$"CBKAAM",db_2014$"XCBKAAW",db_2014$"CBKAAW",db_2014$"XCHISPT",db_2014$"CHISPT",db_2014$"XCHISPM",db_2014$"CHISPM",db_2014$"XCHISPW",db_2014$"CHISPW",db_2014$"XCNHPIT",db_2014$"CNHPIT",db_2014$"XCNHPIM",db_2014$"CNHPIM",db_2014$"XCNHPIW",db_2014$"CNHPIW",db_2014$"XCWHITT",db_2014$"CWHITT",db_2014$"XCWHITM",db_2014$"CWHITM",db_2014$"XCWHITW",db_2014$"CWHITW",db_2014$"XC2MORT",db_2014$"C2MORT",db_2014$"XC2MORM",db_2014$"C2MORM",db_2014$"XC2MORW",db_2014$"C2MORW",db_2014$"XCUNKNT",db_2014$"CUNKNT",db_2014$"XCUNKNM",db_2014$"CUNKNM",db_2014$"XCUNKNW",db_2014$"CUNKNW",db_2014$"XCNRALT",db_2014$"CNRALT",db_2014$"XCNRALM",db_2014$"CNRALM",db_2014$"XCNRALW",db_2014$"CNRALW"),]
db_2015 <- db_2015[order(db_2015$"UNITID",db_2015$"CIPCODE",db_2015$"MAJORNUM",db_2015$"AWLEVEL",db_2015$"XCTOTALT",db_2015$"CTOTALT",db_2015$"XCTOTALM",db_2015$"CTOTALM",db_2015$"XCTOTALW",db_2015$"CTOTALW",db_2015$"XCAIANT",db_2015$"CAIANT",db_2015$"XCAIANM",db_2015$"CAIANM",db_2015$"XCAIANW",db_2015$"CAIANW",db_2015$"XCASIAT",db_2015$"CASIAT",db_2015$"XCASIAM",db_2015$"CASIAM",db_2015$"XCASIAW",db_2015$"CASIAW",db_2015$"XCBKAAT",db_2015$"CBKAAT",db_2015$"XCBKAAM",db_2015$"CBKAAM",db_2015$"XCBKAAW",db_2015$"CBKAAW",db_2015$"XCHISPT",db_2015$"CHISPT",db_2015$"XCHISPM",db_2015$"CHISPM",db_2015$"XCHISPW",db_2015$"CHISPW",db_2015$"XCNHPIT",db_2015$"CNHPIT",db_2015$"XCNHPIM",db_2015$"CNHPIM",db_2015$"XCNHPIW",db_2015$"CNHPIW",db_2015$"XCWHITT",db_2015$"CWHITT",db_2015$"XCWHITM",db_2015$"CWHITM",db_2015$"XCWHITW",db_2015$"CWHITW",db_2015$"XC2MORT",db_2015$"C2MORT",db_2015$"XC2MORM",db_2015$"C2MORM",db_2015$"XC2MORW",db_2015$"C2MORW",db_2015$"XCUNKNT",db_2015$"CUNKNT",db_2015$"XCUNKNM",db_2015$"CUNKNM",db_2015$"XCUNKNW",db_2015$"CUNKNW",db_2015$"XCNRALT",db_2015$"CNRALT",db_2015$"XCNRALM",db_2015$"CNRALM",db_2015$"XCNRALW",db_2015$"CNRALW"),]
db_2016 <- db_2016[order(db_2016$"UNITID",db_2016$"CIPCODE",db_2016$"MAJORNUM",db_2016$"AWLEVEL",db_2016$"XCTOTALT",db_2016$"CTOTALT",db_2016$"XCTOTALM",db_2016$"CTOTALM",db_2016$"XCTOTALW",db_2016$"CTOTALW",db_2016$"XCAIANT",db_2016$"CAIANT",db_2016$"XCAIANM",db_2016$"CAIANM",db_2016$"XCAIANW",db_2016$"CAIANW",db_2016$"XCASIAT",db_2016$"CASIAT",db_2016$"XCASIAM",db_2016$"CASIAM",db_2016$"XCASIAW",db_2016$"CASIAW",db_2016$"XCBKAAT",db_2016$"CBKAAT",db_2016$"XCBKAAM",db_2016$"CBKAAM",db_2016$"XCBKAAW",db_2016$"CBKAAW",db_2016$"XCHISPT",db_2016$"CHISPT",db_2016$"XCHISPM",db_2016$"CHISPM",db_2016$"XCHISPW",db_2016$"CHISPW",db_2016$"XCNHPIT",db_2016$"CNHPIT",db_2016$"XCNHPIM",db_2016$"CNHPIM",db_2016$"XCNHPIW",db_2016$"CNHPIW",db_2016$"XCWHITT",db_2016$"CWHITT",db_2016$"XCWHITM",db_2016$"CWHITM",db_2016$"XCWHITW",db_2016$"CWHITW",db_2016$"XC2MORT",db_2016$"C2MORT",db_2016$"XC2MORM",db_2016$"C2MORM",db_2016$"XC2MORW",db_2016$"C2MORW",db_2016$"XCUNKNT",db_2016$"CUNKNT",db_2016$"XCUNKNM",db_2016$"CUNKNM",db_2016$"XCUNKNW",db_2016$"CUNKNW",db_2016$"XCNRALT",db_2016$"CNRALT",db_2016$"XCNRALM",db_2016$"CNRALM",db_2016$"XCNRALW",db_2016$"CNRALW"),]
db_2017 <- db_2017[order(db_2017$"UNITID",db_2017$"CIPCODE",db_2017$"MAJORNUM",db_2017$"AWLEVEL",db_2017$"XCTOTALT",db_2017$"CTOTALT",db_2017$"XCTOTALM",db_2017$"CTOTALM",db_2017$"XCTOTALW",db_2017$"CTOTALW",db_2017$"XCAIANT",db_2017$"CAIANT",db_2017$"XCAIANM",db_2017$"CAIANM",db_2017$"XCAIANW",db_2017$"CAIANW",db_2017$"XCASIAT",db_2017$"CASIAT",db_2017$"XCASIAM",db_2017$"CASIAM",db_2017$"XCASIAW",db_2017$"CASIAW",db_2017$"XCBKAAT",db_2017$"CBKAAT",db_2017$"XCBKAAM",db_2017$"CBKAAM",db_2017$"XCBKAAW",db_2017$"CBKAAW",db_2017$"XCHISPT",db_2017$"CHISPT",db_2017$"XCHISPM",db_2017$"CHISPM",db_2017$"XCHISPW",db_2017$"CHISPW",db_2017$"XCNHPIT",db_2017$"CNHPIT",db_2017$"XCNHPIM",db_2017$"CNHPIM",db_2017$"XCNHPIW",db_2017$"CNHPIW",db_2017$"XCWHITT",db_2017$"CWHITT",db_2017$"XCWHITM",db_2017$"CWHITM",db_2017$"XCWHITW",db_2017$"CWHITW",db_2017$"XC2MORT",db_2017$"C2MORT",db_2017$"XC2MORM",db_2017$"C2MORM",db_2017$"XC2MORW",db_2017$"C2MORW",db_2017$"XCUNKNT",db_2017$"CUNKNT",db_2017$"XCUNKNM",db_2017$"CUNKNM",db_2017$"XCUNKNW",db_2017$"CUNKNW",db_2017$"XCNRALT",db_2017$"CNRALT",db_2017$"XCNRALM",db_2017$"CNRALM",db_2017$"XCNRALW",db_2017$"CNRALW"),]
#Delete unique key assigned by R so that identical function will work
rownames(source_2010) <- NULL
rownames(db_2010) <- NULL
rownames(source_2011) <- NULL
rownames(db_2011) <- NULL
rownames(source_2012) <- NULL
rownames(db_2012) <- NULL
rownames(source_2013) <- NULL
rownames(db_2013) <- NULL
rownames(source_2014) <- NULL
rownames(db_2014) <- NULL
rownames(source_2015) <- NULL
rownames(db_2015) <- NULL
rownames(source_2016) <- NULL
rownames(db_2016) <- NULL
rownames(source_2017) <- NULL
rownames(db_2017) <- NULL
#compare files
#2010
all(source_2010 == db_2010) #check cell values only
all.equal(source_2010,db_2010) #check cell values and data types and will return the conflicted cells
identical(source_2010,db_2010) #check cell values and data types
which(source_2010!=db_2010,arr.ind=TRUE)
#2011
all(source_2011 == db_2011) #check cell values only
all.equal(source_2011,db_2011) #check cell values and data types and will return the conflicted cells
identical(source_2011,db_2011) #check cell values and data types
which(source_2011!=db_2011,arr.ind=TRUE)
#2012
all(source_2012 == db_2012) #check cell values only
all.equal(source_2012,db_2012) #check cell values and data types and will return the conflicted cells
identical(source_2012,db_2012) #check cell values and data types
which(source_2012!=db_2012,arr.ind=TRUE)
#2013
all(source_2013 == db_2013) #check cell values only
all.equal(source_2013,db_2013) #check cell values and data types and will return the conflicted cells
identical(source_2013,db_2013) #check cell values and data types
which(source_2013!=db_2013,arr.ind=TRUE)
#2014
all(source_2014 == db_2014) #check cell values only
all.equal(source_2014,db_2014) #check cell values and data types and will return the conflicted cells
identical(source_2014,db_2014) #check cell values and data types
which(source_2014!=db_2014,arr.ind=TRUE)
#2015
all(source_2015 == db_2015) #check cell values only
all.equal(source_2015,db_2015) #check cell values and data types and will return the conflicted cells
identical(source_2015,db_2015) #check cell values and data types
which(source_2015!=db_2015,arr.ind=TRUE)
#2016
all(source_2016 == db_2016) #check cell values only
all.equal(source_2016,db_2016) #check cell values and data types and will return the conflicted cells
identical(source_2016,db_2016) #check cell values and data types
which(source_2016!=db_2016,arr.ind=TRUE)
#2017
all(source_2017 == db_2017) #check cell values only
all.equal(source_2017,db_2017) #check cell values and data types and will return the conflicted cells
identical(source_2017,db_2017) #check cell values and data types
which(source_2017!=db_2017,arr.ind=TRUE)
#####################################################################################################################################################################
#Compare source data to fact table
#Insert years into each source file
source_2010 <- add_column(source_2010, yr=2010, .before="UNITID")
source_2011 <- add_column(source_2011, yr=2011, .before="UNITID")
source_2012 <- add_column(source_2012, yr=2012, .before="UNITID")
source_2013 <- add_column(source_2013, yr=2013, .before="UNITID")
source_2014 <- add_column(source_2014, yr=2014, .before="UNITID")
source_2015 <- add_column(source_2015, yr=2015, .before="UNITID")
source_2016 <- add_column(source_2016, yr=2016, .before="UNITID")
source_2017 <- add_column(source_2017, yr=2017, .before="UNITID")
#Delete extra columns
source_2010 <- source_2010[-c(6:52,54:125)]
source_2011 <- source_2011[-c(6,8:65)]
source_2012 <- source_2012[-c(6:7,9:66)]
source_2013 <- source_2013[-c(6,8:65)]
source_2014 <- source_2014[-c(6,8:65)]
source_2015 <- source_2015[-c(6,8:65)]
source_2016 <- source_2016[-c(6,8:65)]
source_2017 <- source_2017[-c(6,8:65)]
#Merge into one file
source <- do.call("rbind", list(source_2010, source_2011, source_2012, source_2013, source_2014, source_2015, source_2016, source_2017))
View(source)
#Remove old source files
rm(source_2010, source_2011, source_2012, source_2013, source_2014, source_2015, source_2016, source_2017)
#Remove old db files
rm(db_2010, db_2011, db_2012, db_2013, db_2014, db_2015, db_2016, db_2017)
# #set working directory and access code to read in SQL queries
# setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# source("../QAQC/readSQL.R")
# getwd()
#turn off strings reading in as factors
options(stringsAsFactors=FALSE)
channel <- odbcDriverConnect('driver={SQL Server}; server=socioeca8; database=dpoe_stage; trusted_connection=true')
#Read in sql query
sql_query <- 'SELECT * FROM ws.dbo.ipeds where vintage_yr = 2019'
database_data <- sqlQuery(channel,sql_query)
odbcClose(channel)
#To see column names in data
# colnames(database_data)
# colnames(source)
#Add in vintage_yr column
source_data <- add_column(source, vintage_yr=2019, .after="CTOTALT")
#Verify that this worked
all(colnames(source_data) == colnames(database_data))
#Check data types
# str(source_data)
# str(database_data)
# all(str(database_data) == str(source_data))
#Convert data types
source_data$yr <- as.integer(source_data$yr)
source_data$vintage_yr <- as.integer(source_data$vintage_yr)
#Order table database_data
database_data <- database_data[order(database_data$yr,database_data$UNITID,database_data$CIPCODE,database_data$MAJORNUM,database_data$AWLEVEL,database_data$CTOTALT,database_data$vintage_yr),]
#Order table source_data
source_data <- source_data[order(source_data$yr,source_data$UNITID,source_data$CIPCODE,source_data$MAJORNUM,source_data$AWLEVEL,source_data$CTOTALT,source_data$vintage_yr),]
#Delete unique key assigned by R so that identical function will work
rownames(source_data) <- NULL
rownames(database_data) <- NULL
#compare files
all(source_data == database_data) #check cell values only
all.equal(source_data,database_data) #check cell values and data types and will return the conflicted cells
identical(source_data,database_data) #check cell values and data types
which(source_data!=database_data,arr.ind=TRUE)
str(source_data)
rm(source_data)
#Add in vintage_yr column
source_data <- add_column(source, vintage_yr=2019, .after="CTOTALT")
str(source_data)
#Add in vintage_yr column
source_data <- as.integer(add_column(source, vintage_yr=2019, .after="CTOTALT"))
rm(source_data)
#Add in vintage_yr column
source_data <- as.integer(add_column(source, vintage_yr=2019, .after="CTOTALT"))
#Add in vintage_yr column
source_data <- add_column(source, vintage_yr=2019, .after="CTOTALT")
#Verify that this worked
# all(colnames(source_data) == colnames(database_data))
#Check data types
# str(source_data)
# str(database_data)
# all(str(database_data) == str(source_data))
#Convert data types
source_data$yr <- as.integer(source_data$yr)
source_data$vintage_yr <- as.integer(source_data$vintage_yr)
#Order table database_data
database_data <- database_data[order(database_data$yr,database_data$UNITID,database_data$CIPCODE,database_data$MAJORNUM,database_data$AWLEVEL,database_data$CTOTALT,database_data$vintage_yr),]
#Order table source_data
source_data <- source_data[order(source_data$yr,source_data$UNITID,source_data$CIPCODE,source_data$MAJORNUM,source_data$AWLEVEL,source_data$CTOTALT,source_data$vintage_yr),]
#Delete unique key assigned by R so that identical function will work
rownames(source_data) <- NULL
rownames(database_data) <- NULL
#compare files
all(source_data == database_data) #check cell values only
all.equal(source_data,database_data) #check cell values and data types and will return the conflicted cells
identical(source_data,database_data) #check cell values and data types
which(source_data!=database_data,arr.ind=TRUE)
